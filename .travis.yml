language: c++
dist: trusty
sudo: true
notifications:
  email: false

# notes:
# because of travis-ci.org time limits, this job will
# only deploy built binaries to github (todo)

matrix:
  include:
  - os: linux
    addons:
      apt:
        sources:
          - sourceline: 'ppa:adrozdoff/cmake'
        packages:
          - cmake
          - cmake-data
          - ninja-build
    env:
      - MATRIX_EVAL="CC=clang && CXX=clang++"
    
# run cmake
before_script:
  - eval "${MATRIX_EVAL}"
  - mkdir build install
  - pushd build
  - cmake -G "Ninja" -DCMAKE_INSTALL_PREFIX=../install -DCMAKE_BUILD_TYPE=Debug -DLLVM_PARALLEL_LINK_JOBS=2 -DLLVM_TARGETS_TO_BUILD="X86" ..
    
# build assets
script:
  # - ninja llc opt -j4
  - ninja check-llvm-codegen-x86 -j4
  
